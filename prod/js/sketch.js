"use strict";document.querySelector("canvas#_imageData").style.display="none";class Screens{constructor(){this.screens=[manyEyes],this.draw=this.screens[0]}rand(){this.draw=this.screens[Math.floor(Math.random()*this.screens.length)]}}let mainCanvas=new Screens;handleTrackingResults=function(e,t,n,i){mainCanvas.draw(e,t,n,i),n.redraw()};let webcamH=document.getElementById("_imageData").height,webcamW=document.getElementById("_imageData").width;function getWebcamVid(e,t,n){t.loadPixels();for(let e=0;e<=n.length;e++)t.pixels[e]=n[e];t.updatePixels()}function stopMouth(e,t,n,i){basicAR(e,t,n,i,noMouth)}function stopEyes(e,t,n,i){basicAR(e,t,n,i,noEyes)}function onFace(e,t,n,i,l){for(let n=0;n<t.length;n++){let i=t[n];if(i.state===e.BRFState.FACE_TRACKING_START||i.state===e.BRFState.FACE_TRACKING)for(let e=0;e<i.vertices.length;e+=2);}}function basicAR(e,t,n,i,...l){getWebcamVid(t,n,i);for(let i=0;i<t.length;i++){let c=t[i];c.state!==e.BRFState.FACE_TRACKING_START&&c.state!==e.BRFState.FACE_TRACKING||l.forEach(e=>{e(c,n)})}}function cyclops(e,t,n,i){getWebcamVid(t,n,i);let l=null,c=null;for(let i=0;i<t.length;i++)(c=t[i]).state!==e.BRFState.FACE_TRACKING_START&&c.state!==e.BRFState.FACE_TRACKING||(l=n.get(c.vertices[72]-5,c.vertices[73]-10,45,20),n.image(l,c.vertices[54]-27,c.vertices[55]-50),n.rect(c.vertices[96]-5,c.vertices[101]-20,c.vertices[108]-c.vertices[96],c.vertices[115]-c.vertices[103]+10),n.fill(0))}function manyEyes(e,t,n,i){getWebcamVid(t,n,i);let l=null,c=null,s=null;for(let i=0;i<t.length;i++)if((s=t[i]).state===e.BRFState.FACE_TRACKING_START||s.state===e.BRFState.FACE_TRACKING){l=n.get(s.vertices[72]-5,s.vertices[73]-10,45,20),c=n.get(s.vertices[84]-5,s.vertices[85]-10,45,20);for(let e=0;e<s.vertices.length;e+=2)e%3==0&&n.image(l,s.vertices[e],s.vertices[e+1]),e%4==0&&n.image(c,s.vertices[e],s.vertices[e+1])}}function noEyes(e,t){t.rect(e.vertices[72]-5,e.vertices[73]-10,e.vertices[90]+10-e.vertices[72],30),t.fill(0)}function noMouth(e,t){t.rect(e.vertices[96],e.vertices[101]-10,e.vertices[108]-e.vertices[96],e.vertices[115]-e.vertices[103]+10),t.fill(0)}function censorSmile(e,t){}function checkBlink(e,t){let n=[],i=!1,l=-1;function c(){i=!1}function s(e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}for(let r=0;r<t.length;r++){let o=t[r];if(o.state===e.BRFState.FACE_TRACKING){let e,t,r,a,u=o.vertices;for(0===n.length&&s(u),e=36,t=41,r=0;e<=t;e++)r+=u[2*e+1]-n[2*e+1];for(r/=6,e=42,t=47,a=0;e<=t;e++)a+=u[2*e+1]-n[2*e+1];a/=6;let f=0;f+=u[55]-n[55],f+=u[57]-n[57],f+=u[59]-n[59],f+=u[61]-n[61],f/=4;let x=Math.abs((r+a)/f);x>12&&(r>.4||a>.4)&&(console.log("blink "+x.toFixed(2)+" "+r.toFixed(2)+" "+a.toFixed(2)+" "+f.toFixed(2)),i=!0,l>-1&&clearTimeout(l),l=setTimeout(c,150));let v=41215;return i&&(v=16765440),s(u),i?1:0}}}function smileCheck(e,t){let n=new e.Point,i=new e.Point,l=e.BRFv4PointUtils.setPoint,c=e.BRFv4PointUtils.calcDistance;for(let s=0;s<t.length;s++){let r=t[s];if(r.state===e.BRFState.FACE_TRACKING_START||r.state===e.BRFState.FACE_TRACKING){l(r.vertices,48,n),l(r.vertices,54,i);let e=c(n,i);l(r.vertices,39,i),l(r.vertices,42,n);let t=e/c(n,i);(t-=1.4)>.25&&(t=.25),t<0&&(t=0),(t*=4)<0&&(t=0),t>1&&(t=1);return(100*t).toFixed(0)}}}!function(e){e.BRFv4PointUtils={setPoint:function(e,t,n){n.x=e[2*t],n.y=e[2*t+1]},applyMovementVector:function(e,t,n,i){e.x=t.x+n.x*i,e.y=t.y+n.y*i},interpolatePoint:function(e,t,n,i){e.x=t.x+i*(n.x-t.x),e.y=t.y+i*(n.y-t.y)},getAveragePoint:function(e,t){e.x=0,e.y=0;for(let n=0,i=t.length;n<i;n++)e.x+=t[n].x,e.y+=t[n].y;e.x/=l,e.y/=l},calcMovementVector:function(e,t,n,i){e.x=i*(n.x-t.x),e.y=i*(n.y-t.y)},calcMovementVectorOrthogonalCW:function(t,n,i,l){e.BRFv4PointUtils.calcMovementVector(t,n,i,l);let c=t.x,s=t.y;t.x=-s,t.y=c},calcMovementVectorOrthogonalCCW:function(t,n,i,l){e.BRFv4PointUtils.calcMovementVector(t,n,i,l);let c=t.x,s=t.y;t.x=s,t.y=-c},calcIntersectionPoint:function(e,t,n,i,l){let c=n.x-t.x;0==c&&(c=.01);let s=n.y-t.y;0==s&&(s=.01);let r=l.x-i.x;0==r&&(r=.01);let o=l.y-i.y;0==o&&(o=.01);let a=s/c,u=n.y-a*n.x,f=o/r,x=a-f;0==x&&(x=.01);let v=l.y-f*l.x-u;0==v&&(v=.01);let h=v/x,y=a*h+u;e.x=h,e.y=y},calcDistance:function(e,t){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},calcAngle:function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)},toDegree:function(e){return 180*e/Math.PI},toRadian:function(e){return e*Math.PI/180}}}(brfv4);let x=null,y=null,radius=10,angle=0,speed=.005,t=0,k=null;function imineStart(e,n,i,l){i.background(0),i.push(),i.translate(centerX,centerY),i.rotate(angle);for(let e=1;e<=12;e++)x=0+radius*i.cos(angle),y=0+radius*i.sin(angle),e%2==0&&i.rotate(-angle),c.setLineDash([3,20]),i.noFill(),i.stroke("white"),i.strokeWeight(2),i.ellipse(y,x,30*e,30*e);radius=0,i.pop(),c.setLineDash([1,0]),i.noFill(),i.strokeWeight(3),i.stroke(" #add8e6"),i.noStroke(),i.fill(255),i.ellipse(centerX,centerY,150,80),k=i.map(i.noise(angle),0,1,0,70,!0),i.fill(155),i.ellipse(centerX-k+10,centerY,80,80),i.fill(0),i.ellipse(centerX-k+10,centerY,40,40),i.fill(255),i.ellipse(centerX-k+10+13,centerY-13,10,10),i.ellipse(centerX-k+10+5,centerY-5,5,5),i.fill(0),i.fill(" #add8e6"),i.textSize(50),i.text("iMine",centerX-60,centerY+120),i.textSize(40),i.text("hold metal sides to start",centerY-120,centerY+170),radius=0,angle+=speed,t<80&&t++}let inc=.01;function whiteNoise(e,t,n,i){let l=0;n.loadPixels();for(let e=0;e<n.height;e++){let t=0;for(let i=0;i<n.width;i++){let l=4*(i+e*n.width),c=n.random(255);n.pixels[l+0]=c,n.pixels[l+1]=c,n.pixels[l+2]=c,n.pixels[l+3]=255,t+=inc}l+=inc}n.updatePixels()}